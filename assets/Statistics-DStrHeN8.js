import{r as d,j as e,B as g,b as N}from"./index-D3IqNoI3.js";import{C as T}from"./CustomSelect-BuY_noT6.js";import{g as F}from"./icons-CLJUmBxH.js";import{u as $}from"./useStatistics-D4aB-ld5.js";const C="_wrapper_fzhc7_1",w="_label_fzhc7_13",D="_input_fzhc7_25",O="_error_fzhc7_58",S="_errorText_fzhc7_62",_={wrapper:C,label:w,input:D,error:O,errorText:S},h=d.forwardRef(({label:t,error:s,type:a="text",onChange:i,className:l,...r},c)=>{const n=d.useId(),m=r.id??n;return e.jsxs("div",{className:[_.wrapper,l??""].filter(Boolean).join(" "),children:[t&&e.jsx("label",{className:_.label,htmlFor:m,children:t}),e.jsx("input",{ref:c,type:a,id:m,className:[_.input,s?_.error:""].filter(Boolean).join(" "),onChange:u=>i?.(u.target.value),...r}),s&&e.jsx("span",{className:_.errorText,children:s})]})});h.displayName="CustomInput";function E(t,s){const[a,i]=d.useState(t);return d.useEffect(()=>{const l=setTimeout(()=>i(t),s);return()=>clearTimeout(l)},[t,s]),a}const z=250,I=[{value:"",label:"Все типы"},{value:"buy",label:"Покупка"},{value:"sell",label:"Продажа"}],b=t=>{const s=t.split("-").map(Number);if(s.length!==3||s.some(r=>Number.isNaN(r)))return new Date(t);const[a,i,l]=s;return new Date(a,i-1,l)},L=t=>b(t).setHours(0,0,0,0),B=t=>b(t).setHours(23,59,59,999),A=(t,s)=>{const a=s.dateFrom?L(s.dateFrom):null,i=s.dateTo?B(s.dateTo):null,l=s.asset.toLowerCase(),r=s.type;return t.filter(c=>{const n=c.name.toLowerCase(),m=new Date(c.date).getTime(),u=l?n.includes(l):!0,v=r?c.type===r:!0,j=a!==null?m>=a:!0,f=i!==null?m<=i:!0;return u&&v&&j&&f})},P="_wrapper_1o4pz_1",W={wrapper:P};function R({operations:t,onFilterChange:s}){const[a,i]=d.useState({asset:"",type:"",dateFrom:"",dateTo:""}),l=E(a.asset,z),r=(n,m)=>{i(u=>({...u,[n]:m}))},c=()=>{i({asset:"",type:"",dateFrom:"",dateTo:""})};return d.useEffect(()=>{const n=A(t,{...a,asset:l});s(n)},[l,a.type,a.dateFrom,a.dateTo,t,s]),e.jsxs("div",{className:W.wrapper,children:[e.jsx(h,{label:"Фильтр по активу",type:"text",placeholder:"Введите название",value:a.asset,onChange:n=>r("asset",n)}),e.jsx(T,{value:a.type,options:I,onChange:n=>r("type",n),ariaLabel:"Тип операции"}),e.jsx(h,{label:"Дата от:",type:"date",value:a.dateFrom,onChange:n=>r("dateFrom",n)}),e.jsx(h,{label:"Дата до:",type:"date",value:a.dateTo,onChange:n=>r("dateTo",n)}),e.jsx(g,{variant:"primary",onClick:c,children:"Сбросить"})]})}const H="_item_1y61i_1",V="_top_1y61i_19",Y="_name_1y61i_33",k="_nameWrapper_1y61i_43",U="_icon_1y61i_55",q="_meta_1y61i_69",G="_type_1y61i_85",J="_buy_1y61i_99",K="_sell_1y61i_109",M="_bottom_1y61i_119",Q="_left_1y61i_135",X="_price_1y61i_147",Z="_amount_1y61i_149",ee="_total_1y61i_169",o={item:H,top:V,name:Y,nameWrapper:k,icon:U,meta:q,type:G,buy:J,sell:K,bottom:M,left:Q,price:X,amount:Z,total:ee};function te({op:t}){const s=F(t.id);return e.jsxs("li",{className:o.item,children:[e.jsxs("div",{className:o.top,children:[e.jsxs("div",{className:o.nameWrapper,children:[s&&e.jsx("img",{src:s,alt:t.name,className:o.icon}),e.jsx("div",{className:o.name,children:t.name})]}),e.jsxs("div",{className:o.meta,children:[e.jsx("span",{className:`${o.type} ${t.type==="buy"?o.buy:o.sell}`,children:t.type==="buy"?"Куплено":"Продано"}),e.jsx("span",{className:o.date,children:new Date(t.date).toLocaleString()})]})]}),e.jsxs("div",{className:o.bottom,children:[e.jsxs("div",{className:o.left,children:[e.jsxs("div",{className:o.price,children:["$",t.price.toFixed(2)]}),e.jsxs("div",{className:o.amount,children:["× ",t.amount]})]}),e.jsxs("div",{className:o.total,children:["$",t.total.toFixed(2)]})]})]})}const se="_list_8bfj5_1",ae="_empty_8bfj5_65",x={list:se,empty:ae};function ne({operations:t}){return t.length===0?e.jsx("p",{className:x.empty,children:"Пока нет операций"}):e.jsx("ul",{className:x.list,children:t.slice().reverse().map(s=>e.jsx(te,{op:s},s.operationId))})}const oe="_grid_1bulh_1",le="_card_1bulh_15",re="_label_1bulh_23",ie="_value_1bulh_33",ce="_positive_1bulh_45",me="_negative_1bulh_53",p={grid:oe,card:le,label:re,value:ie,positive:ce,negative:me};function de({stats:t}){return e.jsx("div",{className:p.grid,children:t.map((s,a)=>e.jsxs("div",{className:p.card,children:[e.jsx("div",{className:p.label,children:s.label}),e.jsx("div",{className:`${p.value} ${s.highlight==="positive"?p.positive:s.highlight==="negative"?p.negative:""}`,children:s.value})]},a))})}const pe="_page_ay3mz_1",ue="_header_ay3mz_17",_e="_operations_ay3mz_75",y={page:pe,header:ue,operations:_e};function ve(){const{totalSpent:t,totalEarned:s,netProfit:a,operationsCount:i}=$(),l=N(m=>m.operations),[r,c]=d.useState(l),n=[{label:"Потрачено",value:`$${t.toFixed(2)}`},{label:"Заработано",value:`$${s.toFixed(2)}`},{label:"Прибыль",value:`$${a.toFixed(2)}`,highlight:a>=0?"positive":"negative"},{label:"Операций",value:i.toString()}];return e.jsxs("div",{className:y.page,children:[e.jsx("div",{className:y.header,children:e.jsx("h1",{children:"Статистика операций"})}),e.jsx(de,{stats:n}),e.jsxs("section",{className:y.operations,children:[e.jsx("h2",{children:"История операций"}),e.jsx(R,{operations:l,onFilterChange:c}),e.jsx(ne,{operations:r})]})]})}export{ve as default};
