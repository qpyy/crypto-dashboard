const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReusableLineChart-D2aXdnY8.js","assets/index-D3IqNoI3.js","assets/index-B4xW3sFB.css","assets/format-4LxHVCiI.js","assets/colors-7KqRPQvr.js","assets/ReusableLineChart-BDzwuJzT.css"])))=>i.map(i=>d[i]);
import{u as h,s as b,a as f,b as S,r as _,j as e,B as v,c as j,d as $,e as w,f as W,_ as E}from"./index-D3IqNoI3.js";import{C as P}from"./CustomSelect-BuY_noT6.js";import{u as B}from"./useStatistics-D4aB-ld5.js";const M="_panel_ggnsr_1",D="_controls_ggnsr_17",F="_input_ggnsr_23",R="_adjust_ggnsr_61",q="_actionButtons_ggnsr_94",I="_sellAllWrapper_ggnsr_114",i={panel:M,controls:D,input:F,adjust:R,actionButtons:q,sellAllWrapper:I};function L(){const s=h(b),t=h(f(s)),{portfolio:o,buy:n,sell:a}=S(),[r,p]=_.useState(0),m=1e-4,d=o.find(c=>c.id===s)?.amount||0,l=j[s]||s,C=()=>p(c=>Math.max(Math.round((c-m)*1e5)/1e5,0)),g=()=>p(c=>Math.round((c+m)*1e5)/1e5),y=c=>{const z=Math.max(Number(c),0);p(Math.round(z*1e5)/1e5)},N=()=>{!s||t<=0||r<=0||n(s,l,t,r)},k=()=>{!s||r<=0||a(s,t,r)},A=()=>{!s||d<=0||a(s,t,d)};return e.jsxs("div",{className:i.panel,children:[e.jsxs("div",{className:i.controls,children:[e.jsx("button",{type:"button",className:i.adjust,onClick:C,children:"-"}),e.jsx("input",{type:"number",value:r.toFixed(4),min:0,step:m,onChange:c=>y(c.target.value),className:i.input}),e.jsx("button",{type:"button",className:i.adjust,onClick:g,children:"+"})]}),e.jsxs("div",{className:i.actionButtons,children:[e.jsx(v,{variant:"primary",size:"md",onClick:N,disabled:t<=0||r<=0,children:"Купить"}),e.jsx(v,{variant:"danger",size:"md",onClick:k,disabled:r<=0||r>d,children:"Продать"})]}),e.jsx("div",{className:i.sellAllWrapper,children:e.jsx(v,{fullWidth:!0,variant:"warning",size:"md",onClick:A,disabled:d<=0,children:"Продать всё"})})]})}const T=(s,t=1)=>{const{showSnackbar:o}=$(),n=_.useRef(null),a=w({queryKey:["chart",s,t],queryFn:()=>W(s,t),staleTime:6e4,refetchInterval:!1,retry:1});return _.useEffect(()=>{if(!a.isError){n.current=null;return}const r=a.error instanceof Error?a.error.message:"Ошибка при загрузке графика";n.current!==r&&(n.current=r,o(r,"error"))},[a.isError,a.error,o]),a},K="_skeleton_w7znu_1",O={skeleton:K},H=_.lazy(()=>E(()=>import("./ReusableLineChart-D2aXdnY8.js"),__vite__mapDeps([0,1,2,3,4,5])));function Q(){const s=h(b),{data:t}=T(s,1);return e.jsx(_.Suspense,{fallback:e.jsx("div",{className:O.skeleton}),children:e.jsx(H,{data:t,dataKey:"price",title:`График цены ${s.toUpperCase()}`,height:300})})}const U="_headerDashboard_13zv1_1",V="_dashboardWrapper_13zv1_9",G="_card_13zv1_20",J="_cardContent_13zv1_156",X="_mono_13zv1_172",u={headerDashboard:U,dashboardWrapper:V,card:G,cardContent:J,mono:X},Y=({label:s,value:t,color:o,custom:n})=>e.jsxs("div",{className:u.card,children:[e.jsx("h4",{children:s}),n&&e.jsx("div",{className:u.cardContent,children:n}),t!==void 0&&e.jsx("div",{className:u.cardContent,children:e.jsx("p",{className:u.mono,style:{color:o||"var(--text-color)"},children:t})})]});function Z(){const{balance:s,realizedProfit:t,unrealizedProfit:o,operationsCount:n}=B(),a=h(b),r=h(l=>l.setSelectedAsset),p=h(f(a)),m=Object.keys(j).map(l=>({value:l,label:j[l]})),d=[{label:"Баланс",value:`$ ${s.toFixed(2)}`},{label:"Актив",custom:e.jsx(P,{fullWidth:!0,value:a,options:m,onChange:r,ariaLabel:"Выбор актива"})},{label:"Стоимость актива",value:`$ ${p.toFixed(2)}`},{label:"Реализовано",value:`$ ${t.toFixed(2)}`,color:t>=0?"var(--primary-color)":"var(--error-color)"},{label:"В позициях",value:`$ ${o.toFixed(2)}`,color:o>=0?"var(--primary-color)":"var(--error-color)"},{label:"Операций",value:n}];return e.jsx("div",{className:u.headerDashboard,children:e.jsx("div",{className:u.dashboardWrapper,children:d.map(l=>e.jsx(Y,{...l},l.label))})})}const ee="_container_1x52e_13",se="_tradeChart_1x52e_27",x={container:ee,tradeChart:se,"trade-panel-wrapper":"_trade-panel-wrapper_1x52e_43","chart-wrapper":"_chart-wrapper_1x52e_45"};function ne(){return e.jsxs("div",{className:x.container,children:[e.jsx(Z,{}),e.jsxs("div",{className:x.tradeChart,children:[e.jsx("div",{className:x["trade-panel-wrapper"],children:e.jsx(L,{})}),e.jsx("div",{className:x["chart-wrapper"],children:e.jsx(Q,{})})]})]})}export{ne as default};
